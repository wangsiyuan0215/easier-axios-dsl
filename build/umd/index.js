(function(i,_){typeof exports=="object"&&typeof module<"u"?_(exports,require("qs"),require("axios")):typeof define=="function"&&define.amd?define(["exports","qs","axios"],_):(i=typeof globalThis<"u"?globalThis:i||self,_(i["easier-axios-dsl"]={},i.qs,i.axios))})(this,function(i,_,N){"use strict";const o={GET:"GET",PUT:"PUT",POST:"POST",DELETE:"DELETE",PATCH:"PATCH",OPTIONS:"OPTIONS",HEAD:"HEAD"},M=3e3,I={JSON:"application/json",FORM_DATA:"multipart/form-data"},R={JSON:"json",TEXT:"text",BLOB:"blob",ARRAY_BUFFER:"arraybuffer",STREAM:"stream",DOCUMENT:"document"},U=({requestInterceptors:t,responseInterceptors:e,...n})=>{const s=N.create({timeout:M,...n});return t.length&&s.interceptors.request.use(...t),e.length&&s.interceptors.response.use(...e),async function({url:r,method:c,data:O,params:u,returnResponse:P,__isFormData:d,...D}){const{headers:A={},responseType:f,...S}=D||{};try{const T=await s({url:r,method:c,headers:{...A,"Content-Type":d?I.FORM_DATA:A&&A["Content-Type"]||I.JSON},...[o.POST,o.PUT,o.PATCH].includes(c)?{data:d?Object.keys(u).reduce((l,E)=>(l.append(E,u[E]),l),new FormData):u}:{},...[o.GET,o.DELETE,o.OPTIONS,o.HEAD].includes(c)?{params:u}:{},...S});return[R.BLOB,R.STREAM,R.DOCUMENT,R.ARRAY_BUFFER].includes(f)||P?T:T.data}catch(T){throw T}}},h=t=>Object.prototype.toString.call(t)==="[object Array]";function b(t){return t==null?!0:typeof t=="boolean"?!1:typeof t=="number"?isNaN(t)||t===0:typeof t=="string"?t.trim().length===0:h(t)?t.length===0:g(t)?Object.keys(t).length===0:t instanceof Map||t instanceof Set?t.size===0:!1}const g=t=>t!==null&&(typeof t=="object"||typeof t=="function")&&!h(t)&&!(t instanceof Date)&&!(t instanceof Map),m=(t,e)=>{const n={...t};return e.forEach(s=>{delete n[s]}),n},y=(t,e)=>t.replace(/{([^{]*)}/g,(n,s)=>e[s]),j=t=>{const[e]=t.split("?");return e},p=(t,e)=>!t||!(e!=null&&e.length)?{}:e.reduce((n,s)=>({...n,[s]:t[s]}),{}),x=(t,e,n,s)=>[t,p(e,n),p(e,s)],C=(t,e,n,s,a,r)=>{const c=m(t,[...r||[],...a||[]]);return[e||n?c:p(c,s||[]),p(t,a),p(t,r)]},F=/\s{1,}/,H="*",$=/\s\[d|(data)]\s?/,w=/\s(d|(data))\.(f|formData):/,B=/\s+(d|data)(\.(f|formData))?:(\S*)(\s|$)/,L=/\s+path:(\S*)(\s|$)/,Y=/\s+(q|query):(\S*)(\s|$)/,G=t=>{const[e,n]=t.split(F);if(!e||!o[e==null?void 0:e.toUpperCase()])throw new Error(`[${t}]: Invalid method: ${e}, please use one of the following methods: ${Object.values(o).join(", ")}`);const s=/^\/?(\{[a-zA-Z_][\w]*\}|[a-zA-Z0-9_\-\.]+)(\/(\{[a-zA-Z_][\w]*\}|[a-zA-Z0-9_\-\.]+))*([?][^ ]*)?$/;if(!n||/^\s*$/.test(n)||!s.test(n==null?void 0:n.trim()))throw new Error(`[${t}]: Invalid url: ${n}, please input a valid url, e.g. /a/b/c, /a/b/{c}, {a}/b/c, a/b/c, a/{b}/c`);return{method:e,url:n}},Q=t=>{const[,e]=t.match(L)||[];return(e==null?void 0:e.split(","))||[]},q=t=>{const[,,e]=t.match(Y)||[];return(e==null?void 0:e.split(","))||[]},z=t=>{const[,,,,e]=t.match(B)||[];return(e==null?void 0:e.split(","))||[]},Z=t=>$.test(t),J=t=>w.test(t),W=t=>!!(t!=null&&t.length)&&t[0]===H,X=(t,e)=>{const n=Q(e),s=q(e),a=z(e),r=!!n.length,c=Z(e),O=c?!1:J(e),u=W(a);return(...P)=>{const[d,D={},A={}]=P,[f,S,T]=c?x(d,D,n,s):C(d,u,O,a,n,s),{method:l,url:E}=G(e),k=r?y(E,S):E,K=b(T)?"":`?${_.stringify(T)}`;return t({url:`${j(k)}${K}`,method:l.toLocaleUpperCase(),...g(f)&&!h(f)&&b(f)?{}:{params:f},...m(A,["url","data","method","params","returnResponse"]),...O?{__isFormData:O}:{},...A.returnResponse?{returnResponse:!0}:{}})}},V=t=>{const e=U(t);return{generatorAPIS:s=>Object.keys(s).reduce((a,r)=>({...a,[r]:X(e,s[r])}),{}),requestInstance:e}};i.init=V,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
